<html>
<div class="center-align">
    Students <br><br>
    <a id="fs-edit-button" class="waves-effect waves-light btn-small green darken-1"
        onclick="toggleFinalStudentTextInput()"><i class="material-icons right">email</i>EDIT</a>
    <a id="fSEmailButton" class="waves-effect waves-light btn-small disabled green darken-1"
        onclick="confirmSendFinalStudentEmails()"><i class="material-icons right">
            <div id="fSEmailButtonIcon">lock_outline</div>
        </i>SEND</a>
</div>
<script>
    google.script.run
        .withSuccessHandler(doFinalSectionUpdate)
        .withFailureHandler(toastUnknownError)
        .getProgramState();

    //Handle SENDING final student emails
    function confirmSendFinalStudentEmails() {
        confirmExecution(sendFinalStudentEmails, "Are you sure you would like to send the final student emails?");
    }

    function sendFinalStudentEmails() {
        setTitleText("Sending Final Student Emails")
        showProgressBar();
        google.script.run
            .withSuccessHandler(handleFinalStudentEmailSendResult)
            .withFailureHandler(toastUnknownError)
            .sendFinalStudentEmails();
    }

    function handleFinalStudentEmailSendResult(response) {
        setTitleTextFinished();
        toastResponseWithMsg(response)
        hideProgressBar();
        google.script.run
            .withSuccessHandler(doFinalSectionUpdate)
            .withFailureHandler(toastUnknownError)
            .getProgramState();
        resetTitleText();
    }
</script>

</html>